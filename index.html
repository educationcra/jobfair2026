<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRA Job Fair &amp; Education 2026 - Registration</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    /* คงค่า Style เดิมของคุณไว้ 100% ทุกประการ */
    body { box-sizing: border-box; font-family: 'Sarabun', 'Tahoma', 'Arial', sans-serif; }
    * { font-family: 'Sarabun', 'Tahoma', 'Arial', sans-serif !important; }
    .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08); }
    .option-card { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; border: 2px solid transparent; background: white; position: relative; overflow: hidden; }
    .option-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(139, 92, 246, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%); opacity: 0; transition: opacity 0.4s ease; }
    .option-card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(139, 92, 246, 0.15); }
    .option-card:hover::before { opacity: 1; }
    .option-card.selected { border-color: #8b5cf6; background: linear-gradient(135deg, rgba(139, 92, 246, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%); box-shadow: 0 12px 32px rgba(139, 92, 246, 0.25); transform: translateY(-4px); }
    .option-card.selected .check-indicator { opacity: 1; transform: scale(1); }
    .check-indicator { position: absolute; top: 12px; right: 12px; width: 28px; height: 28px; background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; opacity: 0; transform: scale(0); transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
    .btn-primary { background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); transition: all 0.3s ease; position: relative; overflow: hidden; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(139, 92, 246, 0.35); }
    .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .btn-secondary { transition: all 0.3s ease; border: 2px solid #e5e7eb; background: white; }
    .btn-secondary:hover { border-color: #8b5cf6; background: #faf5ff; transform: translateY(-2px); }
    .progress-container { position: relative; display: flex; justify-content: space-between; align-items: center; max-width: 450px; margin: 0 auto; }
    .progress-line { position: absolute; top: 50%; left: 0; right: 0; height: 3px; background: #e5e7eb; transform: translateY(-50%); z-index: 0; }
    .progress-line-fill { height: 100%; background: linear-gradient(90deg, #8b5cf6 0%, #ec4899 100%); transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); width: 0%; }
    .progress-step { width: 50px; height: 50px; border-radius: 50%; background: white; border: 3px solid #e5e7eb; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 16px; color: #9ca3af; position: relative; z-index: 1; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
    .progress-step.active { background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); color: white; border-color: #8b5cf6; transform: scale(1.15); box-shadow: 0 8px 20px rgba(139, 92, 246, 0.4); }
    .progress-step.completed { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; border-color: #6366f1; }
    .input-field { transition: all 0.3s ease; border: 2px solid #e5e7eb; background: white; }
    .input-field:focus { outline: none; border-color: #8b5cf6; box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1); transform: translateY(-1px); }
    .section-header { position: relative; padding-bottom: 16px; margin-bottom: 32px; }
    .section-header::after { content: ''; position: absolute; bottom: 0; left: 0; width: 80px; height: 4px; background: linear-gradient(90deg, #8b5cf6 0%, #ec4899 100%); border-radius: 2px; }
    .fade-in { animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .spinner { border: 3px solid rgba(255, 255, 255, 0.3); border-top: 3px solid white; border-radius: 50%; width: 20px; height: 20px; animation: spin 0.8s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .checkbox-custom { width: 22px; height: 22px; cursor: pointer; accent-color: #8b5cf6; border-radius: 6px; }
    .info-box { background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(147, 51, 234, 0.1) 100%); border-left: 4px solid #3b82f6; border-radius: 12px; padding: 20px; margin-bottom: 24px; }
    .warning-box { background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(217, 119, 6, 0.1) 100%); border-left: 4px solid #f59e0b; border-radius: 12px; padding: 20px; margin-bottom: 24px; }
    .toast-message { position: fixed; top: 24px; right: 24px; padding: 16px 24px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15); z-index: 1000; display: flex; align-items: center; gap: 12px; font-weight: 500; animation: slideInRight 0.3s ease; }
    @keyframes slideInRight { from { opacity: 0; transform: translateX(100px); } to { opacity: 1; transform: translateX(0); } }
    .date-option-card { transition: all 0.3s ease; cursor: pointer; border: 2px solid #e5e7eb; }
    .date-option-card.selected { border-color: #8b5cf6 !important; background: linear-gradient(135deg, rgba(139, 92, 246, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%); }
    .highlight-box { background: linear-gradient(135deg, rgba(139, 92, 246, 0.12) 0%, rgba(236, 72, 153, 0.12) 100%); border: 2px solid #8b5cf6; border-radius: 16px; padding: 24px; margin-bottom: 24px; }
    .benefits-list { list-style: none; padding: 0; margin: 16px 0; }
    .benefits-list li { padding: 8px 0; padding-left: 32px; position: relative; color: #1f2937; font-size: 15px; line-height: 1.6; }
    .benefits-list li::before { content: '\2713'; position: absolute; left: 8px; color: #10b981; font-weight: bold; font-size: 18px; }
  </style>
 </head>
 <body class="h-full">
  <main class="h-full w-full overflow-auto" id="mainContainer" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);">
   <div class="max-w-5xl mx-auto px-4 py-12 sm:px-6 lg:px-8">
    <header class="text-center mb-12 fade-in">
     <div class="inline-block mb-6">
      <div class="w-20 h-20 mx-auto rounded-full bg-white shadow-2xl flex items-center justify-center mb-4">
       <svg class="w-12 h-12 text-purple-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
      </div>
     </div>
     <div id="formSubtitle" class="text-white leading-relaxed mt-6 px-4" style="font-size: 18px;">
      <p class="mb-2" style="font-size: 18px;"><strong>นิทรรศการแนะแนวอาชีพและการศึกษาต่อราชวิทยาลัยจุฬาภรณ์</strong></p>
     </div>
     <h1 id="formTitle" class="text-4xl sm:text-5xl font-bold my-4 text-yellow-400" style="font-weight: 800;">CRA Job Fair &amp; Education 2026</h1>
     <div class="text-base sm:text-lg text-white leading-relaxed mt-6 px-4">
      <p class="mb-2 text-2xl font-bold">วันที่ 12-13 กุมภาพันธ์ 2569</p>
      <p class="mb-2 text-xl font-bold">แบบฟอร์มลงทะเบียนผู้ประกอบการออกบูธ</p>
      <p>ห้อง Convention Hall ชั้น 6<br>อาคารกรมพระศรีสวางควัฒน โรงพยาบาลจุฬาภรณ์</p>
     </div>
    </header>

    <div id="progressBar" class="mb-12 fade-in hidden">
     <div class="progress-container">
      <div class="progress-line"><div id="progressLineFill" class="progress-line-fill"></div></div>
      <div class="progress-step" data-step="1">1</div>
      <div class="progress-step" data-step="2">2</div>
      <div class="progress-step" data-step="3">3</div>
     </div>
    </div>

    <div class="glass-card rounded-3xl p-8 sm:p-12 fade-in">
     <form id="registrationForm">
      <section id="section1" class="section-content">
       <div class="section-header"><h2 class="text-2xl sm:text-3xl font-bold text-gray-800">ความประสงค์เข้าร่วมงาน</h2></div>
       <div class="highlight-box fade-in">
        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
         <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> ขอความร่วมมือในสิ่งที่ผู้ประกอบการต้องจัดเตรียม
        </h3>
        <ul class="benefits-list">
         <li>เปิดรับสมัครตำแหน่งนักศึกษาฝึกงาน</li>
         <li>เปิดรับสมัครงานในทุกตำแหน่งงานว่าง</li>
         <li>เปิดรับสมัครงานในตำแหน่งงาน Part-time</li>
         <li>เปิดรับ CV และ Resume ของผู้มาร่วมงาน</li>
         <li>เปิดรับสมัครตำแหน่งสำหรับผู้พิการ (ถ้ามี)</li>
         <li>ส่งข้อมูลพนักงานในองค์กรของท่านที่เป็นศิษย์เก่าราชวิทยาลัยจุฬาภรณ์ (ถ้ามี)</li>
        </ul>
       </div>

       <div class="mb-10"><label class="block text-lg font-semibold text-gray-700 mb-6">หน่วยงานของท่านมีความประสงค์เข้าร่วมออกบูธ CRA Job Fair 2026 หรือไม่ <span class="text-red-500">*</span></label>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
         <div class="option-card rounded-2xl p-6 text-left" data-interest="yes">
          <div class="check-indicator"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg></div>
          <div class="flex items-center mb-2"><span class="font-semibold text-gray-800 text-lg">ต้องการเข้าร่วมออกบูธ</span></div>
          <p class="text-sm text-gray-600">พร้อมเข้าร่วมงาน CRA Job Fair 2026</p>
         </div>
         <div class="option-card rounded-2xl p-6 text-left" data-interest="no">
          <div class="check-indicator"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg></div>
          <div class="flex items-center mb-2"><span class="font-semibold text-gray-800 text-lg">ยังไม่สะดวกเข้าร่วม</span></div>
          <p class="text-sm text-gray-600">ไม่สามารถเข้าร่วมในปีนี้</p>
         </div>
        </div>
       </div>

       <div id="declineSection" class="hidden mb-10 slide-in">
        <div class="warning-box">
         <p class="text-gray-700 font-medium mb-6">เราเสียดายที่คุณไม่สามารถเข้าร่วมในปีนี้ กรุณากรอกข้อมูลด้านล่าง</p>
         <div class="mb-6"><label for="declineCompanyName" class="block text-gray-700 font-semibold mb-3">ชื่อบริษัท / หน่วยงาน <span class="text-red-500">*</span></label><input type="text" id="declineCompanyName" class="input-field w-full px-5 py-4 rounded-xl"></div>
         <div class="mb-6"><label for="declineReason" class="block text-gray-700 font-semibold mb-3">เหตุผลที่ยังไม่สะดวกเข้าร่วมในปีนี้ (ถ้ามี)</label><textarea id="declineReason" class="input-field w-full px-5 py-4 rounded-xl" rows="4" placeholder="ระบุเหตุผล..."></textarea></div>
         <button type="button" id="submitDecline" class="btn-primary w-full text-white font-semibold py-4 px-8 rounded-xl shadow-lg flex items-center justify-center">
          <span id="submitDeclineText">ส่งข้อมูล</span>
          <div id="submitDeclineSpinner" class="spinner ml-3 hidden"></div>
         </button>
        </div>
       </div>

       <div id="participationTypeSection" class="hidden slide-in">
        <h3 class="text-xl font-bold text-gray-800 mb-6">ประเภทการเข้าร่วมของหน่วยงานคุณ <span class="text-red-500">*</span></h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
         <div class="option-card rounded-2xl p-6 text-left" data-type="new"><div class="check-indicator"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg></div><span class="font-semibold text-gray-800">บริษัทลงทะเบียนใหม่</span></div>
         <div class="option-card rounded-2xl p-6 text-left" data-type="returning"><div class="check-indicator"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg></div><span class="font-semibold text-gray-800">บริษัทที่ร่วมงานปีที่ผ่านมา</span></div>
         <div class="option-card rounded-2xl p-6 text-left" data-type="education"><div class="check-indicator"><svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg></div><span class="font-semibold text-gray-800 text-sm">ด้านการศึกษา/ต่างประเทศ/สนับสนุน</span></div>
        </div>

        <div id="newCompanyFields" class="hidden mb-10"><div class="info-box">
          <div class="mb-6"><label for="newCompanyName" class="block text-gray-700 font-semibold mb-3">ชื่อบริษัท / หน่วยงาน <span class="text-red-500">*</span></label><input type="text" id="newCompanyName" class="input-field w-full px-5 py-4 rounded-xl" placeholder="กรอกชื่อบริษัทหรือหน่วยงาน"></div>
          <div class="mb-6"><label for="newOrgType" class="block text-gray-700 font-semibold mb-3">ประเภทองค์กร <span class="text-red-500">*</span></label>
           <select id="newOrgType" class="input-field w-full px-5 py-4 rounded-xl bg-white">
            <option value="">-- เลือกประเภทองค์กร --</option>
            <optgroup label="วันแรก 12 ก.พ. 2568">
              <option value="โรงพยาบาล (ภาครัฐและเอกชน)" data-date="12">โรงพยาบาล (ภาครัฐและเอกชน)</option>
              <option value="องค์กรด้านการแพทย์และสุขภาพ" data-date="12">องค์กรด้านการแพทย์และสุขภาพ</option>
            </optgroup>
            <optgroup label="วันที่สอง 13 ก.พ. 2568">
              <option value="อุตสาหกรรมอาหารและยา" data-date="13">อุตสาหกรรมอาหารและยา</option>
              <option value="เทคโนโลยีดิจิทัล Data และงานวิจัย" data-date="13">เทคโนโลยีดิจิทัล Data และงานวิจัย</option>
            </optgroup>
           </select>
          </div>
        </div></div>

        <div id="returningCompanyFields" class="hidden mb-10">
          <select id="returningCompany" class="input-field w-full px-5 py-4 rounded-xl bg-white">
            <option value="">-- เลือกบริษัทที่ร่วมงานปีที่ผ่านมา --</option>
            <option value="โรงพยาบาลจุฬาภรณ์" data-date="12-13 กุมภาพันธ์ 2568" data-type="ราชวิทยาลัยจุฬาภรณ์">โรงพยาบาลจุฬาภรณ์</option>
            <option value="บริษัท จัดหางาน จ๊อบไทย จำกัด" data-date="12-13 กุมภาพันธ์ 2568" data-type="ผู้สนับสนุน">บริษัท จัดหางาน จ๊อบไทย จำกัด</option>
          </select>
        </div>

        <div id="educationFields" class="hidden mb-10">
          <input type="text" id="educationName" class="input-field w-full px-5 py-4 rounded-xl mb-4" placeholder="ชื่อหน่วยงาน/สถาบัน *">
          <select id="educationOrgType" class="input-field w-full px-5 py-4 rounded-xl bg-white">
            <option value="สถาบันการศึกษา/การศึกษาต่อ">สถาบันการศึกษา/การศึกษาต่อ</option>
            <option value="ที่ปรึกษาเรียนต่อและทำงานต่างประเทศ">ที่ปรึกษาเรียนต่อและทำงานต่างประเทศ</option>
          </select>
        </div>

        <div id="dateSelectionSection" class="hidden mb-10">
           <label class="block text-gray-700 font-semibold mb-3">วันที่เข้าร่วมงาน <span class="text-red-500">*</span> <span id="autoDateBadge" class="hidden ml-2 bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">เลือกอัตโนมัติ</span></label>
           <div class="space-y-3">
             <div class="date-option-card rounded-xl p-4" data-date-choice="12 กุมภาพันธ์ 2568">12 กุมภาพันธ์ 2568 (โรงพยาบาล/บริการสุขภาพ)</div>
             <div class="date-option-card rounded-xl p-4" data-date-choice="13 กุมภาพันธ์ 2568">13 กุมภาพันธ์ 2568 (เทคโนโลยี/Data/วิจัย/อาหาร-ยา)</div>
             <div class="date-option-card rounded-xl p-4" data-date-choice="12-13 กุมภาพันธ์ 2568">เข้าร่วมทั้ง 2 วัน (สถาบันการศึกษา/ผู้สนับสนุน)</div>
           </div>
        </div>

        <div class="flex justify-end"><button type="button" id="nextToSection2" class="btn-primary text-white font-semibold py-4 px-10 rounded-xl shadow-lg">ถัดไป</button></div>
       </div>
      </section>

      <section id="section2" class="section-content hidden">
       <div class="section-header"><h2 class="text-2xl sm:text-3xl font-bold text-gray-800">ข้อมูลผู้ประสานงาน</h2></div>
       <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
        <div><select id="titlePrefix" class="input-field w-full px-5 py-4 rounded-xl bg-white"><option value="นาย">นาย</option><option value="นาง">นาง</option><option value="นางสาว">นางสาว</option></select></div>
        <div><input type="text" id="firstName" class="input-field w-full px-5 py-4 rounded-xl" placeholder="ชื่อ *"></div>
        <div><input type="text" id="lastName" class="input-field w-full px-5 py-4 rounded-xl" placeholder="นามสกุล *"></div>
       </div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <div><input type="text" id="position" class="input-field w-full px-5 py-4 rounded-xl" placeholder="ตำแหน่ง *"></div>
        <div><input type="text" id="lineId" class="input-field w-full px-5 py-4 rounded-xl" placeholder="Line ID *"></div>
       </div>
       <div class="mb-6"><input type="email" id="email" class="input-field w-full px-5 py-4 rounded-xl" placeholder="อีเมล *"></div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div><input type="tel" id="phone" class="input-field w-full px-5 py-4 rounded-xl" placeholder="เบอร์โทรศัพท์ *"></div>
        <div><input type="text" id="phoneExt" class="input-field w-full px-5 py-4 rounded-xl" placeholder="ต่อ (ถ้ามี)"></div>
       </div>
       <div class="flex justify-between">
        <button type="button" onclick="goToSection(1)" class="btn-secondary text-gray-700 font-semibold py-4 px-10 rounded-xl">ย้อนกลับ</button>
        <button type="button" id="nextToSection3" class="btn-primary text-white font-semibold py-4 px-10 rounded-xl shadow-lg">ถัดไป</button>
       </div>
      </section>

      <section id="section3" class="section-content hidden">
       <div class="section-header"><h2 class="text-2xl sm:text-3xl font-bold text-gray-800">รายละเอียดบูธ</h2></div>
       <div class="mb-8">
        <label for="boothStaffCount" class="block text-gray-700 font-semibold mb-3">จำนวนผู้มาออกบูธ (สูงสุด 5 คน) *</label>
        <input type="number" id="boothStaffCount" class="input-field w-full px-5 py-4 rounded-xl" min="1" max="5" value="1">
       </div>
       <div class="space-y-4 mb-8">
        <label class="flex items-start space-x-4 p-5 bg-gray-50 rounded-xl cursor-pointer"><input type="checkbox" id="requestLargerBooth" class="checkbox-custom mt-1"><span>ขอบูธมากกว่าขนาดมาตรฐาน (2x2 ม.)</span></label>
        <label class="flex items-start space-x-4 p-5 bg-gray-50 rounded-xl cursor-pointer"><input type="checkbox" id="requestOther" class="checkbox-custom mt-1"><span>อื่น ๆ (ระบุ)</span></label>
        <textarea id="requestOtherDetail" class="input-field w-full px-5 py-4 rounded-xl hidden" rows="3" placeholder="ระบุรายละเอียดเพิ่มเติม..."></textarea>
       </div>
       <div class="mb-8 p-6 bg-purple-50 rounded-xl">
        <p class="font-bold mb-4">นำเสนอบนเวที 3 นาทีหรือไม่ *</p>
        <div class="grid grid-cols-2 gap-4">
          <div class="option-card p-4 text-center rounded-xl font-bold" data-presentation="yes">ประสงค์</div>
          <div class="option-card p-4 text-center rounded-xl font-bold" data-presentation="no">ไม่ประสงค์</div>
        </div>
       </div>
       <div class="mb-8"><label class="flex items-start space-x-4 p-6 rounded-xl border-2 border-purple-300 bg-purple-50 cursor-pointer"><input type="checkbox" id="consent" class="checkbox-custom mt-1"><span class="text-sm">ยินยอมให้ใช้ข้อมูลเพื่อการจัดงาน CRA Job Fair 2026 และประสานงานที่เกี่ยวข้อง *</span></label></div>
       <div class="flex justify-between">
        <button type="button" onclick="goToSection(2)" class="btn-secondary text-gray-700 font-semibold py-4 px-10 rounded-xl">ย้อนกลับ</button>
        <button type="submit" id="submitBtn" class="btn-primary text-white font-semibold py-4 px-10 rounded-xl flex items-center shadow-lg">
          <span id="submitBtnText">ส่งแบบฟอร์มลงทะเบียน</span>
          <div id="submitSpinner" class="spinner ml-3 hidden"></div>
        </button>
       </div>
      </section>
     </form>
    </div>

    <div id="thankYouMessage" class="hidden glass-card rounded-3xl p-12 text-center fade-in">
     <div class="mb-8 flex justify-center"><div class="w-32 h-32 rounded-full bg-green-500 flex items-center justify-center text-white text-6xl">✓</div></div>
     <h2 class="text-3xl font-bold text-gray-800 mb-4">ลงทะเบียนสำเร็จ!</h2>
     <p class="text-lg text-gray-700 mb-8">ทีมงานได้รับข้อมูลของท่านเรียบร้อยแล้ว<br>จะรีบประสานงานกลับไปโดยเร็วที่สุด</p>
     <button onclick="location.reload()" class="btn-primary text-white font-semibold py-4 px-10 rounded-xl shadow-lg">กลับหน้าแรก</button>
    </div>
   </div>
  </main>

  <script>
    // [สำคัญ] เปลี่ยน URL นี้เป็น URL Web App ของคุณที่ Deploy จาก Google Script
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzM5PdjRQCaOYf4adLiwZtnzL_doZV-iFkhPEU30fyflOXLw__uuzZLrHb_QlbBM1PH/exec";
    
    let formData = { booth_staff_count: 1 };
    let currentSection = 1;

    // --- Logic การแสดงผล (UI Handlers) ---
    
    // การเลือกความประสงค์ (Section 1)
    document.querySelectorAll('[data-interest]').forEach(card => {
      card.onclick = () => {
        document.querySelectorAll('[data-interest]').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        formData.participation_interest = card.dataset.interest;
        const isYes = card.dataset.interest === 'yes';
        document.getElementById('participationTypeSection').classList.toggle('hidden', !isYes);
        document.getElementById('declineSection').classList.toggle('hidden', isYes);
        document.getElementById('progressBar').classList.toggle('hidden', !isYes);
      };
    });

    // ประเภทหน่วยงาน
    document.querySelectorAll('[data-type]').forEach(card => {
      card.onclick = () => {
        document.querySelectorAll('[data-type]').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        formData.participation_type = card.dataset.type;
        
        document.getElementById('newCompanyFields').classList.toggle('hidden', card.dataset.type !== 'new');
        document.getElementById('returningCompanyFields').classList.toggle('hidden', card.dataset.type !== 'returning');
        document.getElementById('educationFields').classList.toggle('hidden', card.dataset.type !== 'education');
        document.getElementById('dateSelectionSection').classList.remove('hidden');
      };
    });

    // Auto-select วันที่จากประเภท (New Company)
    document.getElementById('newOrgType').onchange = function() {
        const dateType = this.options[this.selectedIndex].dataset.date;
        const val = dateType === "12" ? "12 กุมภาพันธ์ 2568" : "13 กุมภาพันธ์ 2568";
        autoSelectDate(val);
    };

    // Auto-select เมื่อเจอคำว่า จุฬาภรณ์
    document.getElementById('newCompanyName').oninput = function() {
        if(this.value.includes('จุฬาภรณ์')) autoSelectDate('12-13 กุมภาพันธ์ 2568');
    };

    // Returning Company Logic
    document.getElementById('returningCompany').onchange = function() {
        const opt = this.options[this.selectedIndex];
        if(opt.value) {
            formData.organization_type = opt.dataset.type;
            autoSelectDate(opt.dataset.date);
        }
    };

    function autoSelectDate(val) {
        document.querySelectorAll('.date-option-card').forEach(card => {
            if(card.dataset.dateChoice === val) {
                card.click();
                document.getElementById('autoDateBadge').classList.remove('hidden');
            }
        });
    }

    document.querySelectorAll('.date-option-card').forEach(card => {
        card.onclick = () => {
            document.querySelectorAll('.date-option-card').forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            formData.event_date = card.dataset.dateChoice;
        };
    });

    // Navigation
    function goToSection(n) {
        document.querySelectorAll('.section-content').forEach(s => s.classList.add('hidden'));
        document.getElementById(`section${n}`).classList.remove('hidden');
        currentSection = n;
        document.getElementById('progressLineFill').style.width = (n-1)*50 + '%';
        document.querySelectorAll('.progress-step').forEach(s => {
            const step = parseInt(s.dataset.step);
            s.classList.toggle('active', step === n);
            s.classList.toggle('completed', step < n);
        });
        window.scrollTo(0,0);
    }

    document.getElementById('nextToSection2').onclick = () => {
        if(!formData.event_date) return alert("กรุณาเลือกวันที่เข้าร่วม");
        goToSection(2);
    };
    document.getElementById('nextToSection3').onclick = () => goToSection(3);

    document.getElementById('requestOther').onchange = function() {
        document.getElementById('requestOtherDetail').classList.toggle('hidden', !this.checked);
    };

    document.querySelectorAll('[data-presentation]').forEach(card => {
        card.onclick = () => {
            document.querySelectorAll('[data-presentation]').forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            formData.interested_in_presentation = card.dataset.presentation === 'yes';
        };
    });

    // --- Final Submission Handler (Fetch API) ---
    
    async function handleFinalSubmit(mode) {
        const btn = mode === 'decline' ? document.getElementById('submitDecline') : document.getElementById('submitBtn');
        const loader = mode === 'decline' ? document.getElementById('submitDeclineSpinner') : document.getElementById('submitSpinner');
        
        if (mode === 'decline') {
            formData.company_name = document.getElementById('declineCompanyName').value;
            formData.decline_reason = document.getElementById('declineReason').value;
            formData.participation_interest = "no";
        } else {
            // Step 1 mapping
            if(formData.participation_type === 'new') {
                formData.company_name = document.getElementById('newCompanyName').value;
                formData.organization_type = document.getElementById('newOrgType').value;
            } else if(formData.participation_type === 'returning') {
                formData.company_name = document.getElementById('returningCompany').value;
            } else {
                formData.company_name = document.getElementById('educationName').value;
                formData.organization_type = document.getElementById('educationOrgType').value;
            }

            // Step 2 & 3 mapping
            formData.title_prefix = document.getElementById('titlePrefix').value;
            formData.first_name = document.getElementById('firstName').value;
            formData.last_name = document.getElementById('lastName').value;
            formData.position = document.getElementById('position').value;
            formData.line_id = document.getElementById('lineId').value;
            formData.email = document.getElementById('email').value;
            formData.phone = document.getElementById('phone').value;
            formData.phone_ext = document.getElementById('phoneExt').value;
            formData.booth_staff_count = document.getElementById('boothStaffCount').value;
            formData.request_larger_booth = document.getElementById('requestLargerBooth').checked;
            formData.request_other = document.getElementById('requestOther').checked;
            formData.request_other_detail = document.getElementById('requestOtherDetail').value;
            formData.consent = document.getElementById('consent').checked;

            if(!formData.consent) return alert("กรุณายินยอมให้ใช้ข้อมูล");
        }

        if(!formData.company_name) return alert("กรุณาระบุชื่อบริษัท");

        btn.disabled = true;
        loader.classList.remove('hidden');

        try {
            await fetch(SCRIPT_URL, {
                method: "POST",
                mode: "no-cors", // จำเป็นสำหรับข้ามโดเมนจาก GitHub
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(formData)
            });
            // สำเร็จ
            document.querySelector('.glass-card').classList.add('hidden');
            document.getElementById('progressBar').classList.add('hidden');
            document.getElementById('thankYouMessage').classList.remove('hidden');
        } catch (e) {
            alert("เกิดข้อผิดพลาดในการส่งข้อมูล");
            btn.disabled = false;
            loader.classList.add('hidden');
        }
    }

    document.getElementById('registrationForm').onsubmit = (e) => {
        e.preventDefault();
        handleFinalSubmit('full');
    };
    
    document.getElementById('submitDecline').onclick = () => handleFinalSubmit('decline');

  </script>
 </body>
</html>
